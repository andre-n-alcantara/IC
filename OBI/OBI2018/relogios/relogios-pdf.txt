Olimpíada Brasileira de Informática - OBI2018 — Prog. Nível 1 — Fase Estadual 5

Relógios

Nome do arquivo: “relogios.x”, onde x deve ser clcpplpasljavaljslpy2Ipy3

É como se diz: mesmo um relógio parado está certo duas vezes
por dia. Quer dizer, se um relógio está parado com seus ponteiros
marcando, digamos, 7:32, e você olhar para ele exatamente às
7:32 da manhã, ou da noite, o relógio vai lhe mostrar a hora
certa! O coelho branco está atrasado, muito atrasado. Ele precisa
chegar ao seu destino o mais rápido possível, mas não pode, de
Jeito nenhum, mas de jeito nenhum mesmo, passar por um relógio
que não esteja lhe mostrando a hora certa.

O coelho branco está na sala do canto superior esquerdo de um palácio que é um quadriculado de
salas iguais, cada uma delas contendo um relógio cujo marcador está dividido em K unidades de
tempo, de O a K — 1, e que possuem apenas um ponteiro. Alguns relógios estão parados, enquanto
os demais funcionam perfeitamente sincronizados. O coelho precisa chegar na sala do canto inferior
direito, pode se mover ortogonalmente apenas e leva exatamente uma unidade de tempo para ir de
uma sala para outra. Ele pode ficar esperando parado, por uma quantidade inteira de unidades de
tempo, numa sala cujo relógio esteja funcionando. Mas ele não pode entrar, nem ficar esperando
parado, em uma sala cujo relógio lhe esteja mostrando a hora errada!

No exemplo da figura, K = 6 e os relógios mostrados estão parados. Nas salas onde a figura não
mostra o relógio, é porque ele está funcionando. Você consegue ver que, para esse exemplo, o tempo
mínimo para o coelho branco chegar na sala inferior direita é 8 unidades de tempo?

Seu programa precisa computar a quantidade mínima de unidades de tempo para o coelho branco
chegar ao destino, se for possível chegar ao destino!

Entrada

A primeira linha da entrada contém três inteiros L, Ce K, indicando, respectivamente, o número de
linhas, o número de colunas e a quantidade de unidades de tempo na qual o marcador dos relógios
está dividido. As L linhas seguintes contêm, cada uma, C' inteiros P, representando o estado dos
relógios em cada sala: P = —1, se o relógio estiver funcionando corretamente; e O < P<K-1,
se estiver parado com o ponteiro na posição P. O relógio na sala inicial, primeira linha e primeira
coluna, está sempre parado na posição 0.

Saída

Imprima um inteiro, representando a quantidade mínima de unidades de tempo para o coelho branco
chegar ao destino. Se não for possível, imprima —1.

Restrições

e2<L,C<100
c2<K<I0

e-I<P<kK-1

Informações sobre a pontuação

e Para um conjunto de casos de teste valendo 25 pontos, L<20,C<20e K<ã10;
 Olimpíada Brasileira de Informática - OBI2018

Prog. Nível 1 — Fase Estadual

Exemplo de entrada 1

346
0-13-1
41-11
4-12-1

Exemplo de saída 1

8

Exemplo de entrada 2

54 10

0-1-1-1
-1999
49-18
-1-197
-179-1

Exemplo de saída 2

-1

Exemplo de entrada 3

54 10

0-1-1-1
-1999
49-18
-1299
-179-1

Exemplo de saída 3

20

