Olimpíada Brasileira de Informática — OBI2008 — Progr.

amação Nível 2 Fase 2

Frete da Família Silva

Nome do arquivo fonte: frete.c, frete.cpp ou frete.pas

Houve uma determinada época no planeta Terra em que a população estava grande demais, e determinadas
medidas foram tomadas para sanar esse problema. Uma vez que as primeiras colônias já haviam se estabelecido

no planeta Marte, todos os países concordaram em man
Lagosta da Silva, era uma pessoa que valorizava a famí
atitude. Resolveu, então, mandar uma família inteira

ar para lá algumas pessoas. O presidente de Pizzalândia,
ia, e decidiu que não ia separar famílias em nome dessa
para Marte. No caso, a dele mesmo, a família Silva,

provavelmente a mais numerosa do planeta.

Tal família estabeleceu-se em Marte sem problemas, ainda mais com novas invenções que havia por lá. Uma delas
era a pílula de nanicolina, substância descoberta naquele planeta, próximo à uma região onde existem pedras
voadoras, pedras macias e até pedras falantes. Lend:
nanicolina ali num p

s dizem que algum outro ser extra-terrestre depositou a
ado distante, enquanto visitava o planeta. O efeito da pílula de nanicolina é a diminuição
de tamanho de quem a toma, por um determinado tempo. Tal pílula foi, então, produzida em esca
e hoje em dia é distribuída pelos governos marcianos aos colonos que lá residem.

a industrial

aniversário
orte é feito
através de ônibus-flutuadores fretados. Como todos podem tomar pílulas da nanicolina e ficarem minúsculos,
podemos dizer que dentro de cada ônibus-flutuador cabem infinitas pessoas, e que o efeito da pílu
durante toda a viagem.

Assim, o preço de uma viagem de ônibus-flutuador entre duas colônias não depende do número de pessoas que
viajam, sendo um preço fixo. Isso permite que algumas economias sejam feitas. Suponha que existam quatro
colônias dos Silvas em Marte, ilustrados abaixo:

A família Silva, todos os anos, encontra-se em alguma das muitas colônias em Marte para celebrar o
da chegada deles ao planeta. O chefe da família é quem sempre paga o transporte de todos. O trans

a vai durar

Os círculos representam as colônias, e as conexões entre elas representam as estradas existentes.

O número nas conexões representa o preço de uma viagem de ônibus-flutuador em qualquer direção. Ou seja,
Uma viagem da colônia A direto para a colônia C (ou de C para 4), custa 5 moedas de silício, não importa o
número de passageiros.

Suponha que o grande encontro seja na colônia 4. Se o chefe da família pagar o frete de B para 4, de C para
Ae de D para 4, vai acabar gastando 25 moedas.

Mas uma coisa que poderia ser feita, também, é: os Silvas das colônias Be D vão para a C. Da C, todos vão
para a colônia A. Isso tudo teria um gasto de somente 10 moedas.

Este ano o número de colônias dos Silvas aumentou muito em Marte, e o chefe da família está muito preocupado
com o dinheiro que vai gastar para pagar todas as viagens. Então ele contratou você, que é o melhor programador
daquele planeta, a fazer um programa que recebe as informações a respeito das colônias, das estradas e dos fretes
de ônibus-flutuadores, e determine qual é a menor quantidade de dinheiro necessária para custear o transporte
de todos os Silvas para o encontro. O desespero do chefe da família é tanto que ele não se importa em qual
colônia será o encontro, desde que os custos sejam minimizados.

Você pode assumir que:

e Entre duas colônias diferentes existe no máximo uma estrada direta.
 Olimpíada Brasileira de Informática — OBI2008 — Programação Nível 2 Fase 2 8

e Sempre existe um caminho (de uma ou mais estradas) entre quaisquer duas colônias.

Entrada

A entrada contém um único teste, a ser lido da entrada padrão. A primeira linha contém dois inteiros: N e
M (2< N<1000,1<M <j10.000), que representam, respectivamente, o número de colônias e o número de
estradas existentes. Depois, seguem M linhas com 3 inteiros: P,QeU(0O<PQ<N-1,I1I<U< 1000),
indicando que existe uma estrada de mão dupla entre as colônias P e Q, cujo custo do frete de viagem entre
essas duas colônias é U moedas.

Saída

Seu programa deve imprimir, na saída padrão, um único inteiro, representando o número mínimo de moedas
necessárias para custear o transporte de todos os Silvas à colônia onde será realizada o encontro.

Exemplo de entrada Exemplo de saída

10
10

10

NHHooo gs
OUNUWUúNHO
ES

Exemplo de entrada Exemplo de saída

3

NHHOoOoom
VWNWUNHO
VEOH

Informações sobre a pontuação
e Em um conjunto de casos de teste que totaliza 30 pontos, N <10e M < 100.

e Em um conjunto de casos de teste que totaliza 55 pontos, N < 100 e M < 1000.
