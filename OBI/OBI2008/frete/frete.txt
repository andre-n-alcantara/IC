Olimp´ıada Brasileira de Inform´ atica – OBI2008 – Programa¸ c˜ ao N´ıvel 2 Fase 2 7
Frete da Fam ´ılia Silva
Nome do arquivo fonte:frete.c,frete.cppoufrete.pasHouve uma determinada ´ epoca no planeta Terra em que a popula¸ c˜ ao estava grande demais, e determinadasmedidas foram tomadas para sanar esse problema. Uma vez que as primeiras colˆ onias j´ a haviam se estabelecidono planeta Marte, todos os pa´ıses concordaram em mandar para l´ a algumas pessoas. O presidente de Pizzalˆ andia,Lagosta da Silva, era uma pessoa que valorizava a fam´ılia, e decidiu que n˜ ao ia separar fam´ılias em nome dessaatitude. Resolveu, ent˜ ao, mandar uma fam´ılia inteira para Marte. No caso, a dele mesmo, a fam´ılia Silva,provavelmente a mais numerosa do planeta.Tal fam´ılia estabeleceu-se em Marte sem problemas, ainda mais com novas inven¸ c˜ oes que havia por l´ a. Uma delasera a p´ılula de nanicolina, substˆ ancia descoberta naquele planeta, pr´ oximo ` a uma regi˜ ao onde existem pedrasvoadoras, pedras macias e at´ e pedras falantes. Lendas dizem que algum outro ser extra-terrestre depositou ananicolina ali num passado distante, enquanto visitava o planeta. O efeito da p´ılula de nanicolina ´ e a diminui¸ c˜ aode tamanho de quem a toma, por um determinado tempo. Tal p´ılula foi, ent˜ ao, produzida em escala industriale hoje em dia ´ e distribu´ıda pelos governos marcianos aos colonos que l´ a residem.A fam´ılia Silva, todos os anos, encontra-se em alguma das muitas colˆ onias em Marte para celebrar o anivers´ arioda chegada deles ao planeta. O chefe da fam´ılia ´ e quem sempre paga o transporte de todos. O transporte ´ e feitoatrav´ es de ˆ onibus-utuadores fretados. Como todos podem tomar p´ılulas da nanicolina ecarem min´ usculos,podemos dizer que dentro de cada ˆ onibus-utuador cabem innitas pessoas, e que o efeito da p´ılula vai durardurante toda a viagem.Assim, o pre¸ co de uma viagem de ˆ onibus-utuador entre duas colˆ onias n˜ ao depende do n´ umero de pessoas queviajam, sendo um pre¸ coxo. Isso permite que algumas economias sejam feitas. Suponha que existam quatrocolˆ onias dos Silvas em Marte, ilustrados abaixo:
ABCD10105432
Os c´ırculos representam as colˆ onias, e as conex˜ oes entre elas representam as estradas existentes.O n´ umero nas conex˜ oes representa o pre¸ co de uma viagem de ˆ onibus-utuador em qualquer dire¸ c˜ ao. Ou seja,Uma viagem da colˆ oniaAdireto para a colˆ oniaC(ou deCparaA), custa 5 moedas de sil´ıcio, n˜ ao importa on´ umero de passageiros.Suponha que o grande encontro seja na colˆ oniaA. Se o chefe da fam´ılia pagar o frete deBparaA, deCparaAe deDparaA, vai acabar gastando 25 moedas.Mas uma coisa que poderia ser feita, tamb´ em, ´ e: os Silvas das colˆ oniasBeDv˜ ao para aC. DaC, todos v˜ aopara a colˆ oniaA. Isso tudo teria um gasto de somente 10 moedas.Este ano o n´ umero de colˆ onias dos Silvas aumentou muito em Marte, e o chefe da fam´ılia est´ a muito preocupadocom o dinheiro que vai gastar para pagar todas as viagens. Ent˜ ao ele contratou vocˆ e, que ´ e o melhor programadordaquele planeta, a fazer um programa que recebe as informa¸ c˜ oes a respeito das colˆ onias, das estradas e dos fretesde ˆ onibus-utuadores, e determine qual ´ e a menor quantidade de dinheiro necess´ aria para custear o transportede todos os Silvas para o encontro. O desespero do chefe da fam´ılia ´ e tanto que ele n˜ ao se importa em qualcolˆ onia ser´ a o encontro, desde que os custos sejam minimizados.Vocˆ e pode assumir que:•Entre duas colˆ onias diferentes existe no m´ aximo uma estrada direta.Olimp´ıada Brasileira de Inform´ atica – OBI2008 – Programa¸ c˜ ao N´ıvel 2 Fase 2 8 •Sempre existe um caminho (de uma ou mais estradas) entre quaisquer duas colˆ onias.
Entrada
A entrada cont´ em um ´ unico teste, a ser lido daentrada padr˜ ao. A primeira linha cont´ em dois inteiros:NeM(2≤N≤1000, 1≤M≤10.000), que representam, respectivamente, o n´ umero de colˆ onias e o n´ umero deestradas existentes. Depois, seguemMlinhas com 3 inteiros:P,QeU(0≤P,Q≤N−1, 1≤U≤1000),indicando que existe uma estrada de m˜ ao dupla entre as colˆ oniasPeQ, cujo custo do frete de viagem entreessas duas colˆ onias ´ eUmoedas.
Sa´ıda
Seu programa deve imprimir, nasa´ıda padr˜ ao, um ´ unico inteiro, representando o n´ umero m´ınimo de moedasnecess´ arias para custear o transporte de todos os Silvas ` a colˆ onia onde ser´ a realizada o encontro.
Exemplo de entrada4 60 1 100 2 50 3 101 2 31 3 42 3 2Exemplo de sa´ıda10
Exemplo de entrada4 60 1 10 2 10 3 11 2 31 3 42 3 2Exemplo de sa´ıda3
Informa¸ c˜ oes sobre a pontua¸ c˜ ao
•Em um conjunto de casos de teste que totaliza 30 pontos,N≤10 eM≤100.•Em um conjunto de casos de teste que totaliza 55 pontos,N≤100 eM≤1000.