Olimpíada Brasileira de Informática - OBI2022 — Prog. Nível 2 — Fase 2 7

Viagem

Nome do arquivo: viagem.c, viagem.cpp, viagem.pas, viagem. java, viagem. js ou viagem.py

Você está viajando pelo arquipélago de Kiri, que é composto por um grande número de ilhas. Não
há pontes entre as ilhas, de modo que a única maneira de viajar entre as ilhas é por navio.

Há várias rotas de navios disponíveis. Cada rota conecta duas ilhas distintas 4 e B e pode ser usada
nas duas direções (de 4 para B ou de B para 4). Cada rota tem um certo tempo de percurso (o
mesmo nas duas direções) e um custo (o mesmo nas duas direções).

No momento você quer ir da ilha X para outra ilha Y, mas quer gastar no máximo um certo valor
com a viagem. Você também está com pressa e gostaria de chegar o mais rapidamente possível ao
seu destino.

Dados a lista das rotas disponíveis, com seus custos e tempos de percurso, escreva um programa
para determinar se é possível chegar ao destino gastando no máximo o valor previsto para a viagem,
e nesse caso qual o menor tempo para chegar ao destino. Note que pode não ser possível chegar ao
destino, seja porque não há rota disponível ou porque o valor alocado para a viagem não é suficiente.

Por exemplo, considere o caso mostrado na figura abaixo, em que você está na ilha 1 e quer ir para
a ilha 4:

T= tempo do percurso
P = custo da passagem

1. Seo valor previsto é 10, a resposta é 5 e o caminho ótimo é 1 > 2 > 4. Note que este caminho
custa 4 + 6 = 10 e demora tempo 4+1 = 5.

2. Se o valor previsto é 7, a resposta é 7 e o caminho ótimo é1 525354, que custa
4+2+1 =7 e demora tempo 4+2+1=7.

3. Se o valor previsto é 3, a resposta é 8 e o caminho ótimo é 1—- > 3— > 4, usando a aresta
entre 1 e 3 que demora tempo 7 e tem custo 2. Note que este caminho custa 2 +1 = 3e
demora tempo 7+1=8.

4. Se o valor previsto é 2, a resposta é 9 e o caminho ótimo é 1— > 3— > 4, usando a aresta entre
1e3 que demora tempo 8 e tem custo 1, note que este caminho custa 1 + 1 = 2 e demora
tempo 8 +19.

5. Se o valor previsto é 1, não existe caminho que satisfaça as restrições, por isso a resposta é
—1.
Entrada

A primeira linha da entrada contém três inteiros V, N e M, respectivamente o valor disponível para
a viagem, o número de ilhas e o número de rotas. As ilhas são identificadas por inteiros de 1 a N.
 Olimpíada Brasileira de Informática - OBI2022 — Prog. Nível 2 — Fase 2 8

Cada uma das M linhas seguintes descreve uma rota e contém quatro inteiros 4;, Bi, T; e P;, onde
A; e B; representam ilhas, T; o tempo de percurso e P; o custo de uma passagem para essa rota. A
última linha da entrada contém dois inteiros X e Y, o início e o destino da sua viagem.

Saída

Seu programa deve produzir uma única linha na saída, que deve conter um único inteiro, o menor
tempo necessário para chegar ao destino, ou o valor —1 caso não seja possível chegar ao destino.

Restrições
e2<N<h10000
ei<M<2000
ei<V<200
c1I<A4A,B<N,4+%B;paral<i<mM.
e Pode haver mais de uma rota entre o mesmo par de ilhas.
e 1<7T;< 100000, paral<i<M.
e0<P,<200,paral<i<M.

C1I<XY<N

Informações sobre a pontuação
e Para um conjunto de casos de testes valendo 20 pontos, N<200e P=0Oparal<i<mM.

e Para um conjunto de casos de testes valendo outros 10 pontos, N < 10 000 e P; = O para
I<i<mM.

e Para um conjunto de casos de testes valendo outros 30 pontos, N < 100e V < 10.

e Para um conjunto de casos de testes valendo outros 40 pontos, nenhuma restrição adicional.

Exemplos

Exemplo de entrada 1 Exemplo de saída 1

10 47 5

RR QAEOwHA
BAREINID ON
HH NON

ON HANS

Exemplo de entrada 2 Exemplo de saída 2

-1

ROO
O UN w
H 0 q w
EN N

